from octorest import OctoRest
import time
try:
    client = OctoRest(url="http://192.168.40.30", apikey="868940A42CF54D4CB2969F27B8CB4B73")
    while 1:
        state = client.job_info()['state']
        state = 'Offline' if state.startswith('Offline') else state
        print(state)
        if state not in ['Offline', 'Connecting', 'Error']:
            temperature=client.printer()['temperature']
            hotend=int(temperature['tool0']['actual'])
            hotend_target=int(temperature['tool0']['target'])
            bed=int(temperature['bed']['actual'])
            bed_target=int(temperature['bed']['target'])

            hotend_string='{}/{}°C'.format(hotend, hotend_target)
            bed_string='{}/{}°C'.format(bed, bed_target)
            print('Hotend:{:>{padding}}'.format(hotend_string, padding=16-len('Hotend:')))
            print('Heatbed:{:>{padding}}'.format(bed_string, padding=16-len('Heatbed:')))

            if state != 'Operational':
                
        time.sleep(1)
except Exception as e:
    print(e)
    print('Lost connection')
